@page
@model Shark.Fido2.Portal.Pages.CredentialsDetailsModel

<div class="main-container">
    <div class="main-section">
        @if (Model.CredentialId == null || Model.CredentialId.Length == 0)
        {
            <div class="alert alert-warning">
                No public key credential details are available. Please sign in first.
            </div>
        }
        else
        {
            <div class="main-header">
                <h2>You are signed in!</h2>
            </div>

            <div class="main-description">
                <p>You have successfully signed in using WebAuthn! Below, you can review the details of the public key credentials used for your authentication. These credentials represent the unique keys stored by your authenticator and used to securely verify your identity.</p>
            </div>

            <div class="card">
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Credential identifier</strong>
                        </div>
                        <div class="col-md-8">
                            <code>@Convert.ToBase64String(Model.CredentialId)</code>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>User handle</strong>
                        </div>
                        <div class="col-md-8">
                            <code>@Convert.ToBase64String(Model.UserHandle)</code>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Username</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.UserName
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Display name</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.UserDisplayName
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Sign count</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.SignCount
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Algorithm</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.Algorithm
                        </div>
                    </div>

                    @if (Model.Transports != null && Model.Transports.Any())
                    {
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <strong>Transports</strong>
                            </div>
                            <div class="col-md-8">
                                <ul class="list-unstyled mb-0">
                                    @foreach (var transport in Model.Transports)
                                    {
                                        <li>@transport</li>
                                    }
                                </ul>
                            </div>
                        </div>
                    }

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Time of creation (UTC)</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.CreatedAt
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <strong>Time of last update (UTC)</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.UpdatedAt
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <strong>Time of last use (UTC)</strong>
                        </div>
                        <div class="col-md-8">
                            @Model.LastUsedAt
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>